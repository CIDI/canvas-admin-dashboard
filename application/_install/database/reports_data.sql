-- phpMyAdmin SQL Dump
-- version 3.3.7deb8
-- http://www.phpmyadmin.net
--
-- Host: localhost
-- Generation Time: Jul 29, 2014 at 10:05 PM
-- Server version: 5.1.73
-- PHP Version: 5.3.3-7+squeeze20

SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;

--
-- Database: `elearn`
--

--
-- Dumping data for table `reports`
--

INSERT INTO `reports` (`id`, `name`, `description`, `sql_query`, `executable`, `code`, `institution_id`) VALUES
(1, 'Syllabus', 'Pull syllabus usage from Canvas for courses with student enrollments per term. Track if using Canvas and if the syllabus section is used. If there is a syllabus, link to syllabus. Make sortable by department/college/instructor. ', 'SELECT \r\nc.canvas_course_id, c.course_id, c.short_name as course_short_name, c.long_name as course_long_name, c.canvas_account_id, c.canvas_term_id, c.term_id, c.status as course_status, c.start_date as course_start_date, c.end_date as course_end_date, c.synced_at as course_synced_at, c.institution_id,\r\nec.role as enrollment_type, ec.enrollments,\r\na.account_id, a.canvas_parent_id, a.parent_account_id,\r\na.name as account_name, a.status as account_status, a.synced_at as account_synced_at,\r\nam.lft, am.rght, am.depth,\r\np_a.name as parent_account_name, p_a.status as parent_account_status, p_a.synced_at as parent_account_synced_at,\r\np_am.lft as parent_lft, p_am.rght as parent_rght, p_am.depth as parent_depth,\r\ne.canvas_user_id as teacher_canvas_user_id, e.user_id as teacher_user_id, e.canvas_section_id, e.section_id, e.status as teacher_status, e.canvas_associated_user_id, e.associated_user_id, e.synced_at as teacher_synced_at, \r\nu.login_id as teacher_login_id, u.first_name as teacher_first_name, u.last_name as teacher_last_name, u.email as teacher_email, u.synced_at as users_synced_at, \r\ncm.id as course_meta_id, cm.meta_category_id, cm.meta_name, cm.meta_value, cm.synced_at as course_meta_synced_at, cm.sort as course_meta_sort\r\nFROM `courses` as c\r\nJOIN enrollment_counts as ec ON (\r\n    c.canvas_course_id = ec.canvas_course_id\r\n    AND ec.role = ''student''\r\n    AND ec.enrollments > 0\r\n    AND c.canvas_term_id = :term\r\n    AND ec.institution_id = :institution\r\n)\r\nJOIN accounts as a ON (\r\n    c.canvas_account_id = a.canvas_account_id\r\n    AND a.institution_id = :institution\r\n)\r\nJOIN account_meta as am ON (\r\n    a.canvas_account_id = am.canvas_account_id \r\n    AND am.canvas_term_id = c.canvas_term_id\r\n    AND am.institution_id = :institution\r\n)\r\nJOIN accounts as p_a ON (\r\n    a.canvas_parent_id = p_a.canvas_account_id\r\n    AND p_a.institution_id = :institution\r\n)\r\nJOIN account_meta as p_am ON (\r\n    a.canvas_parent_id = p_am.canvas_account_id \r\n    AND p_am.canvas_term_id = c.canvas_term_id\r\n    AND p_am.institution_id = :institution\r\n)\r\nJOIN enrollments as e ON (\r\n    c.canvas_course_id = e.canvas_course_id\r\n    AND e.role = ''teacher''\r\n    AND e.institution_id = :institution\r\n)\r\nJOIN users as u ON (\r\n    e.canvas_user_id = u.canvas_user_id\r\n    AND u.institution_id = :institution\r\n)\r\nLEFT JOIN course_meta as cm ON (\r\n    c.canvas_course_id = cm.course_id\r\n    AND cm.meta_category_id = 1\r\n    AND meta_name = ''syllabus_body''\r\n    AND cm.institution_id = :institution\r\n) \r\nWHERE c.institution_id = :institution\r\nORDER BY p_am.lft, p_am.rght, p_a.name, am.lft, am.rght, a.name, a.canvas_account_id, c.long_name, c.canvas_course_id, u.last_name', 1, 'syllabus/dashboard', NULL),
(2, 'LTI Tools', 'A list of all LTI tools being used. When it was added, what privacy level, etc. Sortable by tool/course/department/college.', 'SELECT \r\ncount(c.canvas_course_id) as course_count,\r\nc.institution_id,\r\ncm_name.id as cm_name_id, cm_name.meta_name as cm_name_meta_name, cm_name.meta_value as tool_name,\r\n    cm_name.synced_at as cm_name_synced_at, cm_name.course_id as cm_name_course_id, cm_name.sort as cm_name_sort,\r\ncm_icon.id as cm_icon_id, cm_icon.meta_name as cm_icon_meta_name, cm_icon.meta_value as tool_icon,\r\n    cm_icon.synced_at as cm_icon_synced_at, cm_icon.course_id as cm_icon_course_id, cm_icon.sort as cm_icon_sort\r\nFROM (\r\n	SELECT * FROM courses AS t\r\n	WHERE t.canvas_term_id = :term\r\n    AND t.institution_id = :institution\r\n	) AS c\r\nJOIN (\r\n	SELECT * FROM enrollment_counts AS t\r\n	WHERE t.role = ''student''\r\n    AND t.enrollments > 0\r\n	AND t.canvas_term_id = :term\r\n    AND t.institution_id = :institution\r\n) AS ec ON ( c.canvas_course_id = ec.canvas_course_id )\r\nJOIN (\r\n	SELECT * FROM course_meta AS t\r\n    WHERE t.meta_category_id = 2\r\n    AND t.meta_name = ''name''\r\n	AND t.canvas_term_id = :term\r\n    AND t.institution_id = :institution\r\n) AS cm_name ON ( c.canvas_course_id = cm_name.course_id )\r\nLEFT JOIN (\r\n	SELECT * FROM course_meta as t\r\n    WHERE t.meta_category_id = 2\r\n    AND t.meta_name = ''icon_url''\r\n	AND t.canvas_term_id = :term\r\n    AND t.institution_id = :institution\r\n) AS cm_icon ON (\r\n    cm_name.course_id = cm_icon.course_id\r\n    AND cm_name.sort = cm_icon.sort\r\n) \r\nGROUP BY tool_name\r\nORDER BY tool_name', 1, 'lti/tools', NULL),
(3, 'LTI Course Tools', '', 'SELECT * \r\nFROM course_meta\r\nWHERE meta_category_id = 2\r\nAND course_id = :course\r\nAND institution_id = :institution\r\nORDER BY sort, meta_name', 1, 'lti/course_tools', NULL),
(4, 'LTI Tool Courses', 'List all of the courses for using an LTI tool based on the tool name', 'SELECT \r\nc.institution_id, c.long_name, c.course_id,\r\ncm_name.id as cm_name_id, cm_name.meta_name as cm_name_meta_name, cm_name.meta_value as tool_name,\r\n    cm_name.synced_at as cm_name_synced_at, cm_name.course_id as cm_name_course_id, cm_name.sort as cm_name_sort,\r\ncm_icon.id as cm_icon_id, cm_icon.meta_name as cm_icon_meta_name, cm_icon.meta_value as tool_icon,\r\n    cm_icon.synced_at as cm_icon_synced_at, cm_icon.course_id as cm_icon_course_id, cm_icon.sort as cm_icon_sort\r\nFROM (\r\n    SELECT * FROM courses\r\n    WHERE canvas_term_id = 522\r\n    AND institution_id = 3\r\n    ) AS c\r\nJOIN (\r\n    SELECT * FROM enrollment_counts\r\n    WHERE role = ''student''\r\n    AND enrollments > 0\r\n    AND canvas_term_id = 522\r\n    AND institution_id = 3\r\n) AS ec ON ( c.canvas_course_id = ec.canvas_course_id )\r\nJOIN (\r\n    SELECT * FROM course_meta\r\n    WHERE meta_category_id = 2\r\n    AND meta_name = ''name''\r\n    AND meta_value = ''Dropbox''\r\n    AND canvas_term_id = 522\r\n    AND institution_id = 3\r\n) AS cm_name ON ( c.canvas_course_id = cm_name.course_id )\r\nLEFT JOIN (\r\n    SELECT * FROM course_meta\r\n    WHERE meta_category_id = 2\r\n    AND meta_name = ''icon_url''\r\n    AND canvas_term_id = 522\r\n    AND institution_id = 3\r\n) AS cm_icon ON (\r\n    cm_name.course_id = cm_icon.course_id\r\n    AND cm_name.sort = cm_icon.sort\r\n) \r\nORDER BY c.long_name ASC', 1, 'lti/courses', NULL);
